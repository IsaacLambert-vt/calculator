<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAHTS | Custom Cost Analysis</title>
    <style>
        :root {
            --primary-dark: #1a2a3a;
            --accent-blue: #3498db;
            --success-green: #27ae60;
            --light-bg: #f8fafc;
            --border-color: #e2e8f0;
            --text-main: #334155;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--light-bg); color: var(--text-main); margin: 0; padding: 0; }
        header { background: white; padding: 15px; text-align: center; border-bottom: 1px solid var(--border-color); margin-bottom: 20px; }
        .logo { max-width: 150px; }
        .container { max-width: 1000px; margin: 0 auto 60px auto; background: white; padding: 30px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        h1 { font-size: 1.5rem; text-align: center; color: var(--primary-dark); margin-bottom: 5px; }
        #clientGreeting { font-size: 1.1rem; color: var(--accent-blue); text-align: center; margin-bottom: 25px; font-weight: 500; }
        .inputs-section { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; background: #f1f5f9; padding: 25px; border-radius: 12px; margin-bottom: 30px; }
        .input-group { display: flex; flex-direction: column; }
        label { font-weight: 600; font-size: 0.85rem; margin-bottom: 8px; }
        input, select { padding: 10px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; }
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th { background: var(--primary-dark); color: white; padding: 12px; font-size: 0.8rem; text-transform: uppercase; }
        td { padding: 12px; border-bottom: 1px solid #f1f5f9; font-size: 0.9rem; }
        .total-row { background: #f8fafc; font-weight: 700; border-top: 2px solid var(--primary-dark); }
        .emp-cost-row { background: #effaf3; font-weight: 700; color: var(--success-green); }
        
        /* Sales Tool - HIDDEN BY DEFAULT */
        #salesToolSection { 
            display: none; 
            margin-top: 40px; 
            padding: 20px; 
            background: #fff; 
            border: 2px dashed var(--border-color); 
            border-radius: 12px; 
            text-align: center; 
        }
        .btn { background: var(--accent-blue); color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; margin-top: 10px; }
        #generatedLink { width: 70%; padding: 10px; margin-top: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 0.8rem; }
        .disclaimer { margin-top: 20px; padding: 15px; font-size: 0.8rem; color: #64748b; text-align: center; border-top: 1px solid #eee; }
    </style>
</head>
<body>

<header><img src="logo.png" alt="WAHTS Logo" class="logo"></header>

<div class="container">
    <h1>Interactive Cost Analysis Calculator</h1>
    <div id="clientGreeting">Customized Estimate</div>
    
    <div class="inputs-section">
        <div class="input-group">
            <label>Number of Units</label>
            <input type="number" id="unitCount" value="2" oninput="calculate()">
        </div>
        <div class="input-group">
            <label>Employees in HCP</label>
            <input type="number" id="empCount" value="500" oninput="calculate()">
        </div>
        <div class="input-group">
            <label>Cloud Database Management?</label>
            <select id="cloudNeeded" onchange="calculate()"><option>Yes</option><option>No</option></select>
        </div>
        <div class="input-group">
            <label>Audiologist Review Service?</label>
            <select id="audioNeeded" onchange="calculate()"><option>Yes</option><option>No</option></select>
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead><tr><th>Category</th><th>Year 1</th><th>Year 2</th><th>Year 3</th><th>Year 4</th><th>Year 5</th></tr></thead>
            <tbody id="resultsTable"></tbody>
        </table>
    </div>

    <div id="salesToolSection">
        <h3 style="color:var(--accent-blue)">Admin Sales Tool</h3>
        <p style="font-size:0.8rem; margin-bottom:10px;">Configure the calculator above, then generate the link for the client.</p>
        <input type="text" id="clientNameInput" placeholder="Enter Client Name" style="width: 250px; padding: 8px;">
        <button class="btn" onclick="generateLink()">Generate Client Link</button><br>
        <input type="text" id="generatedLink" readonly placeholder="Link will appear here...">
        <button class="btn" style="background:var(--success-green)" onclick="copyLink()">Copy Link</button>
    </div>

    <div class="disclaimer">
        <p><strong>Pricing Tiers Applied:</strong> 1-3 Units: $7,938 | 4-9 Units: $7,468.50 | 10-19 Units: $6,921.50 | 20+ Units: $6,435</p>
        <p>Â© 2025 WAHTS. All rights reserved.</p>
    </div>
</div>

<script>
    function init() {
        const p = new URLSearchParams(window.location.search);
        
        // Check for Admin Mode
        if (p.get('admin') === 'true') {
            document.getElementById('salesToolSection').style.display = 'block';
        }

        if (p.has('client')) document.getElementById('clientGreeting').innerText = "Prepared for " + p.get('client');
        if (p.has('units')) document.getElementById('unitCount').value = p.get('units');
        if (p.has('emps')) document.getElementById('empCount').value = p.get('emps');
        if (p.has('cloud')) document.getElementById('cloudNeeded').value = p.get('cloud');
        if (p.has('audio')) document.getElementById('audioNeeded').value = p.get('audio');
        calculate();
    }

    function calculate() {
        const u = parseInt(document.getElementById('unitCount').value) || 0;
        const e = parseInt(document.getElementById('empCount').value) || 0;
        const c = document.getElementById('cloudNeeded').value === "Yes";
        const a = document.getElementById('audioNeeded').value === "Yes";
        const price = u >= 20 ? 6435 : (u >= 10 ? 6921.5 : (u >= 4 ? 7468.5 : 7938));
        const cal = c ? 1400 : 1750;
        const rows = [
            { n: "Hardware", v: [u*price, 0, 0, 0, 0], act: true },
            { n: "Calibration", v: [0, u*cal, u*cal, u*cal, u*cal], act: true },
            { n: "Cloud", v: [1700, 1200, 1200, 1200, 1200], act: c },
            { n: "Audiologist", v: Array(5).fill(e*4), act: a }
        ];
        let h = ""; let totals = [0,0,0,0,0];
        rows.forEach(r => {
            h += `<tr><td style="font-weight:500">${r.n}</td>`;
            r.v.forEach((v, i) => {
                if (r.act) { h += `<td>$${v.toLocaleString()}</td>`; totals[i] += v; }
                else h += `<td style="color:#94a3b8">N/A</td>`;
            });
            h += "</tr>";
        });
        h += `<tr class="total-row"><td>Annual Total</td>` + totals.map(t => `<td>$${t.toLocaleString()}</td>`).join('') + `</tr>`;
        h += `<tr class="emp-cost-row"><td>Per Employee</td>` + totals.map(t => `<td>$${(e>0?(t/e).toFixed(2):0)}</td>`).join('') + `</tr>`;
        document.getElementById('resultsTable').innerHTML = h;
    }

    function generateLink() {
        // This keeps your base URL but removes the ?admin=true so the client doesn't see the tool
        const url = window.location.origin + window.location.pathname;
        const name = document.getElementById('clientNameInput').value;
        const u = document.getElementById('unitCount').value;
        const e = document.getElementById('empCount').value;
        const c = document.getElementById('cloudNeeded').value;
        const a = document.getElementById('audioNeeded').value;
        
        document.getElementById('generatedLink').value = `${url}?client=${encodeURIComponent(name)}&units=${u}&emps=${e}&cloud=${c}&audio=${a}`;
    }

    function copyLink() {
        const linkBox = document.getElementById('generatedLink');
        linkBox.select();
        document.execCommand("copy");
        alert("Client Link Copied!");
    }
    init();
</script>
</body>
</html>
